!function(e){var t={};function n(o){if(t[o])return t[o].exports;var a=t[o]={i:o,l:!1,exports:{}};return e[o].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(o,a,function(t){return e[t]}.bind(null,a));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=95)}({95:function(e,t){let n,o={},a={};function l(e,t){return btoa(e+"$ _ _ $"+t)}function r(e){return e.replace(window.root_domain,"<b>"+window.root_domain+"</b>")}function s(){0==Object.keys(o).length?($("#challenges-status").show().html("No DNS challenge found."),$("#challenges-card").hide()):($("#challenges-status").hide(),$("#challenges-card").show())}let i=void 0;window.dns_challenges={init:function(){n=io("/v1/system"),n.on("connect",(function(){console.log("Socket connected."),n.emit("authentication",{key:API_KEY}),n.on("authenticated",(function(){console.log("Socket authenticated."),n.emit("setup",{type:"dns_challenges"})})),n.on("unauthorized",(function(e){$.notify({message:"Unable to authenticate to the socket."},{type:"danger"}),$("#challenges-status").html("Unable to load DNS challenges."),console.log("Unauthorized from the socket",e)}))})),n.on("error",e=>{$.notify({message:"Connection with the socket lost."},{type:"danger"}),$("#challenges-status").html("Connection with the DNS challenges server lost (socket error)."),console.log("Socket error",e)}),n.on("dns_challenges_add",e=>{let t=Math.floor(1e6*Math.random()),{host:n,token:i}=e;var c;o[t]={host:n,token:i},a[l(n,i)]=t,c={cid:t,host:n,token:i},$("#challenges-list").append(`<li class="list-group-item" id="challenge-${c.cid}">\n        ${r(c.host)}<samp class="ml-md-4 text-secondary">${c.token}</samp>\n        <span class="float-md-right"><div class="btn-group" role="group" style="margin: -3px -10px;"><button id="challenge-${c.cid}-rembtn" onclick="dns_challenges.askRemove(${c.cid})" class="btn btn-sm btn-danger"><i class="fas fa-trash-alt"></i> Remove</button></div></span></li>`),s()}),n.on("dns_challenges_remove",e=>{let{host:t,token:n}=e,r=function(e,t){return a[l(e,t)]}(t,n);null!=r&&(delete o[r],delete a[l(t,n)],$("#challenge-"+r).remove(),s())}),n.on("setup",e=>{e.error?($.notify({message:"Cannot setup server connection."},{type:"danger"}),$("#challenges-status").html("Unable to load DNS challenges."),console.log("Socket error",e.error)):s()})},askRemove:function(e){let t=o[e];null!=t&&(i=e,$("#deleteModal-content").html("Do you really want to remove the challenge on host <i>"+r(t.host)+"</i> with value:<br/><samp class='text-secondary'>"+t.token+"</samp><br/><br/><i class='fas fa-exclamation-triangle'></i> Warning: If you didn't create manually this challenge, removing it can cause issues about SSL certificates renewal."),$("#deleteModal").modal())},confirmRemove:function(){$("#deleteModal").modal("hide"),null!=i&&($("#challenge-"+i+"-rembtn").attr("disabled","disabled"),n.emit("dns_challenge_cmd",{command:"remove",...o[i]}),i=void 0)},openAddPopup:function(){$("#addPopup-host").val(""),$("#addPopup-token").val(""),$("#addPopup").modal()},confirmAdd:function(){let e=$("#addPopup-host").val().trim().toLowerCase(),t=$("#addPopup-token").val().trim();e.length>0&&t.length>0?($("#addPopup").modal("hide"),e+="."+window.root_domain,n.emit("dns_challenge_cmd",{command:"set",host:e,token:t})):$.notify({message:"Invalid or empty fields."},{type:"warning",z_index:9999,placement:{from:"bottom",align:"center"},animate:{enter:"animated fadeInUp",exit:"animated fadeOutDown"}})}}}});