!function(e){var t={};function a(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,a),o.l=!0,o.exports}a.m=e,a.c=t,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)a.d(n,o,function(t){return e[t]}.bind(null,o));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=112)}({11:function(e,t,a){"use strict";var n,o=function(){return void 0===n&&(n=Boolean(window&&document&&document.all&&!window.atob)),n},r=function(){var e={};return function(t){if(void 0===e[t]){var a=document.querySelector(t);if(window.HTMLIFrameElement&&a instanceof window.HTMLIFrameElement)try{a=a.contentDocument.head}catch(e){a=null}e[t]=a}return e[t]}}(),s=[];function i(e){for(var t=-1,a=0;a<s.length;a++)if(s[a].identifier===e){t=a;break}return t}function l(e,t){for(var a={},n=[],o=0;o<e.length;o++){var r=e[o],l=t.base?r[0]+t.base:r[0],c=a[l]||0,d="".concat(l," ").concat(c);a[l]=c+1;var u=i(d),p={css:r[1],media:r[2],sourceMap:r[3]};-1!==u?(s[u].references++,s[u].updater(p)):s.push({identifier:d,updater:b(p,t),references:1}),n.push(d)}return n}function c(e){var t=document.createElement("style"),n=e.attributes||{};if(void 0===n.nonce){var o=a.nc;o&&(n.nonce=o)}if(Object.keys(n).forEach((function(e){t.setAttribute(e,n[e])})),"function"==typeof e.insert)e.insert(t);else{var s=r(e.insert||"head");if(!s)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");s.appendChild(t)}return t}var d,u=(d=[],function(e,t){return d[e]=t,d.filter(Boolean).join("\n")});function p(e,t,a,n){var o=a?"":n.media?"@media ".concat(n.media," {").concat(n.css,"}"):n.css;if(e.styleSheet)e.styleSheet.cssText=u(t,o);else{var r=document.createTextNode(o),s=e.childNodes;s[t]&&e.removeChild(s[t]),s.length?e.insertBefore(r,s[t]):e.appendChild(r)}}function f(e,t,a){var n=a.css,o=a.media,r=a.sourceMap;if(o?e.setAttribute("media",o):e.removeAttribute("media"),r&&btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(r))))," */")),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}var h=null,m=0;function b(e,t){var a,n,o;if(t.singleton){var r=m++;a=h||(h=c(t)),n=p.bind(null,a,r,!1),o=p.bind(null,a,r,!0)}else a=c(t),n=f.bind(null,a,t),o=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(a)};return n(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;n(e=t)}else o()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=o());var a=l(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var n=0;n<a.length;n++){var o=i(a[n]);s[o].references--}for(var r=l(e,t),c=0;c<a.length;c++){var d=i(a[c]);0===s[d].references&&(s[d].updater(),s.splice(d,1))}a=r}}}},112:function(e,t,a){"use strict";a.r(t);a(227);Chart.helpers.color;let n=["#3B6A9C","#007BFF","#86C0FF"],o=void 0,r=!1;let s={mem:{},cpu:{}},i=!1;let l={mem:!0,cpu:!1};let c=void 0;function d(){null!=u&&($("#charts-"+u).appendTo("#cell-"+u),u=void 0)}let u=void 0;function p(e,t=0){$("#button-"+e).attr("disabled","disabled").removeClass("btn-info").removeClass("btn-warning").addClass("btn-secondary").html("<i class='fas fa-sync fa-spin'></i>"),setTimeout(()=>{$.getJSON("/api/v1/processes/check/"+e).fail((t,a,n)=>{f(e,!1)}).done(t=>{t.error?f(e,!1):t.running?f(e,!0):$("#button-"+e).removeClass("btn-info").removeClass("btn-secondary").addClass("btn-warning").attr("data-action","start").html("<i class='fas fa-play'></i>").removeAttr("disabled")})},t)}function f(e,t){let a=$("#button-"+e);a.removeAttr("disabled"),t?a.removeClass("btn-warning").addClass("btn-info").removeClass("btn-secondary").html("<i class='fas fa-undo-alt'></i>").attr("data-action","restart"):a.removeClass("btn-warning").removeClass("btn-info").addClass("btn-secondary").html("Check").attr("data-action","check")}function h(e=!0){let t=window.subprocesses[c].check>0;$("#restartModal").modal("hide"),utils.showInfiniteLoading((e?"Restarting":"Starting")+" subprocess..."),$.getJSON("/api/v1/processes/restart/"+c).fail((e,a,n)=>{t&&($.notify({message:"A server error occured during the restart procedure. Open the console for details."},{type:"danger"}),console.warn(n))}).done(e=>{e.error?($.notify({message:"An application occured during the restart procedure. Open the console for details."},{type:"danger"}),console.warn(e.error)):$.notify({message:"Restart signal sent."},{type:"info"})}).always(()=>{utils.hideLoading(),p(c,t?1500:7e3)})}window.processes_usage={init:function(){o=io("/v1/system"),window.socket=o,o.on("connect",(function(){r=!1,console.log("Socket connected."),o.emit("authentication",{key:API_KEY}),o.on("authenticated",(function(){r||(r=!0,console.log("Socket authenticated."),o.emit("setup",{type:"processes",proc:"all"}))})),o.on("unauthorized",(function(e){$.notify({message:"Unable to authenticate to the socket. Please reload the page."},{type:"danger"}),console.error("Unauthorized from the socket",e)})),o.on("setup",e=>{e.error?($.notify({message:"Unable to setup the socket. Please reload the page."},{type:"danger"}),console.error("Socket setup error",e.message)):(!function(){let e=$("#subprocesses-row");if(i)return;i=!0;for(let[t,a]of Object.entries(window.subprocesses))if(!window.not_applicable.includes(t)&&a.check<2){let o=a.check>=0;e.append(`<div class="col-xl-4 col-lg-6 col-12 mb-3 chart-panel" id="cell-${t}"><h5 class="subprocess-title" style="display: inline-block;" data-toggle="tooltip" title="${a.text}">${a.name}<span style="display: none;" class="pid-${t}"></span>:</h5>`+'<div class="btn-group btn-group-sm" style="position: absolute; right: 15; top: -4; height: 31px" role="group">'+(o?`<button class="btn btn-info" data-action="restart" onclick="processes_usage.buttonClicked('${t}')" id="button-${t}"><i class="fas fa-undo-alt"></i></button>`:"")+`<button class="btn btn-secondary" onclick="processes_usage.fullscreen('${t}')"><i class="fas fa-expand-alt"></i></button></div>`+`<div style="width: 100%;" class="row chart-row" id="charts-${t}"><div class="col-12 chart-parent chart-mem"><canvas id="mem-${t}"></canvas></div><div class="col-12 chart-parent chart-cpu" style="display: none;"><canvas id="cpu-${t}"></canvas></div></div></div>`),s.mem[t]=new Chart($("#mem-"+t),{type:"line",data:{datasets:[{label:"RSS",data:[],borderColor:n[0],fill:!1},{label:"Heap Total",data:[],borderColor:n[1],fill:!1},{label:"Heap Used",data:[],borderColor:n[2],fill:!1}]},options:{scales:{xAxes:[{type:"realtime",realtime:{duration:6e4,delay:2e3,pause:!1,ttl:void 0},ticks:{display:!1}}],yAxes:[{type:"linear",ticks:{beginAtZero:!0,suggestedMin:0,suggestedMax:10485760,callback:e=>e<1?e:window.utils.string.formatBytes(e,0,!0)}}]},maintainAspectRatio:!1}}),s.cpu[t]=new Chart($("#cpu-"+t),{type:"line",data:{datasets:[{label:"Process total %",data:[],borderColor:n[0],fill:!1},{label:"User %",data:[],borderColor:n[1],fill:!1},{label:"System %",data:[],borderColor:n[2],fill:!1}]},options:{scales:{xAxes:[{type:"realtime",realtime:{duration:6e4,delay:2e3,pause:!1,ttl:void 0},ticks:{display:!1}}],yAxes:[{type:"linear",ticks:{beginAtZero:!0,suggestedMin:0,suggestedMax:2,callback:e=>e+"%"}}]},maintainAspectRatio:!1}})}e.show(),$("#subprocesses-status").hide(),$('.subprocess-title[data-toggle="tooltip"]').tooltip({html:!0,placement:"bottom",template:"<div class='tooltip subprocess-tooltip' role='tooltip'><div class='arrow'></div><div class='tooltip-inner'></div></div>"})}(),$("#toggle-visible-group").show())}),o.on("usage",e=>{let t=Date.now(),a=s.mem[e.id];if(null!=a){let n=e.mem;a.data.datasets[0].data.push({x:t,y:n.rss}),a.data.datasets[1].data.push({x:t,y:n.heapTotal}),a.data.datasets[2].data.push({x:t,y:n.heapUsed}),a.update({preservation:!0})}let n=s.cpu[e.id];if(null!=n){let a=e.cpu,o=Math.round(a.user/a.total*1e3)/10,r=Math.round(a.sys/a.total*1e3)/10;n.data.datasets[0].data.push({x:t,y:o+r}),n.data.datasets[1].data.push({x:t,y:o}),n.data.datasets[2].data.push({x:t,y:r}),n.update({preservation:!0})}}),o.on("pid",e=>{$(".pid-"+e.id).html(" ("+e.pid+")").show()})})),o.on("error",e=>{$.notify({message:"Connection with the socket lost. Please reload the page."},{type:"danger"}),console.log("Socket error",e)}),$("#fullscreenGraph-modal").on("hidden.bs.modal",()=>{d()})},buttonClicked:function(e){let t=$("#button-"+e).attr("data-action");"restart"==t?function(e){let t=window.subprocesses[e];c=e,$("#restartModal-content").html("Do you want to restart the <i>"+t.name+"</i> subprocess?"),$("#restartModal").modal()}(e):"check"==t?p(e,0):"start"==t&&(c=e,h(!1))},confirmRestart:h,toggleVisible:function(e){let t=$("#toggle-visible-"+e);l[e]=!l[e],$(".toggle-visible").blur(),l[e]?t.addClass("active"):t.removeClass("active");let a=(l.mem?1:0)+(l.cpu?1:0);0==a&&(l["mem"==e?"cpu":"mem"]=!0,$("#toggle-visible-"+("mem"==e?"cpu":"mem")).addClass("active")),l.mem?$(".chart-mem").show():$(".chart-mem").hide(),l.cpu?$(".chart-cpu").show():$(".chart-cpu").hide(),a<=1?($(".chart-parent").removeClass("col-lg-6").addClass("col-12"),$(".chart-panel").addClass("col-xl-4 col-lg-6 col-12").removeClass("col-xl-6")):($(".chart-parent").removeClass("col-12").addClass("col-lg-6"),$(".chart-panel").removeClass("col-xl-4 col-lg-6 col-12").addClass("col-xl-6"))},fullscreen:function(e){d(),u=e,$("#charts-"+e).appendTo("#fullscreenGraph-parent");let t="pid-"+e;$("#fullscreenGraph-title").html(subprocesses[e].name+"<span class='"+t+"'>"+$("."+t).html()+"</span>"),$("#fullscreenGraph-modal").modal()}}},12:function(e,t,a){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var a=function(e,t){var a=e[1]||"",n=e[3];if(!n)return a;if(t&&"function"==typeof btoa){var o=(s=n,i=btoa(unescape(encodeURIComponent(JSON.stringify(s)))),l="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(i),"/*# ".concat(l," */")),r=n.sources.map((function(e){return"/*# sourceURL=".concat(n.sourceRoot||"").concat(e," */")}));return[a].concat(r).concat([o]).join("\n")}var s,i,l;return[a].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(a,"}"):a})).join("")},t.i=function(e,a,n){"string"==typeof e&&(e=[[null,e,""]]);var o={};if(n)for(var r=0;r<this.length;r++){var s=this[r][0];null!=s&&(o[s]=!0)}for(var i=0;i<e.length;i++){var l=[].concat(e[i]);n&&o[l[0]]||(a&&(l[2]?l[2]="".concat(a," and ").concat(l[2]):l[2]=a),t.push(l))}},t}},227:function(e,t,a){var n=a(11),o=a(228);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[e.i,o,""]]);var r={insert:"head",singleton:!1},s=(n(o,r),o.locals?o.locals:{});e.exports=s},228:function(e,t,a){(t=a(12)(!1)).push([e.i,".chart-panel .chart-row {\n    height: 200px;\n    overflow: hidden;\n}\n\n#fullscreenGraph-parent .chart-row {\n    height: 80vh;\n}\n\n.chart-parent {\n    height: 100%;\n}",""]),e.exports=t}});